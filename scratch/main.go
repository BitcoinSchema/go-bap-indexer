package main

import (
	"encoding/hex"
	"log"

	"github.com/BitcoinSchema/go-bap-indexer/crawler"
	"github.com/bitcoin-sv/go-sdk/transaction"
	"github.com/bitcoinschema/go-bob"
)

func main() {
	rawtx, _ := hex.DecodeString("0100000001f47aa0437f82a497b744454ab8eda3148993301dda669283bde2744165195c4c010000006a473044022004f40074f87d00d7f99a9ad1f4ad1bf21153daca3ba78f95d4172ce36d66f5d002207a22d173454e7fabc81facfda72e9a48c3659c9e70b16d46f994b142c5b3643a412103c31bfcb84a699a9148f6ac7561752513dd5f7ac74e5de86fea0c59e040413765ffffffff020000000000000000fd0a02006a2231424150537561506e66476e53424d33474c56397968785564596534764762644d5405414c4941531b476f3876434841613453364168584b5441424770414e697a33354a4d28017b2240636f6e74657874223a2268747470733a2f2f736368656d612e6f7267222c224074797065223a22506572736f6e222c22616c7465726e6174654e616d65223a2257696c6453617463686d6f222c226c6f676f223a2262697466733a2f2f613533323736343231643230363361333330656262663030336162356238643435336438313738316336633834343065326466383333363838363230383263352e6f75742e312e31222c22696d616765223a22222c22686f6d654c6f636174696f6e223a7b224074797065223a22506c616365222c226e616d65223a22426974636f696e227d2c2275726c223a2268747470733a2f2f746f6e6963706f772e636f6d222c227061796d61696c223a2273617463686d6f406d6f6e6579627574746f6e2e636f6d227d017c22313550636948473232534e4c514a584d6f53556157566937575371633768436676610d424954434f494e5f45434453412231486a5465723956676b66654e61466962504238455755474a4c456738794148665941206f0e7ccad6e12ec22b55c5b16d72c547d075660588b15b2dc69172b0daeb1dd61562950f7297285d58f52b92af9ae9323959c83f7a2c179a41cd7c0711bf7dd0e1020000000000001976a914e03177f92eedb58734b6c6a6fe2a956fa60e19bb88ac00000000")

	blockHeight := uint32(761173)
	blockTime := uint32(1665592880)

	// log.Printf("[TX]: %d: %s | Data Length: %d", blockHeight, tx.Id, len(tx.Transaction))
	t, err := transaction.NewTransactionFromBytes(rawtx)
	if err != nil {
		log.Printf("[ERROR]: %v", err)
		return
	}
	var bobTx *bob.Tx
	if bobTx, err = bob.NewFromTx(t); err != nil {
		return
	}

	bobTx.Blk.I = blockHeight
	bobTx.Blk.T = blockTime
	crawler.ProcessTx(bobTx)

}
